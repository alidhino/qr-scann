<!DOCTYPE html>
<html>

<head>
    <title>Scanner</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://unpkg.com/html5-qrcode"></script>
</head>

<body style="text-align:center; font-family:Arial;">

    <h2>Scan QR Tamu</h2>

    <select id="mode" style="font-size:18px; padding:10px; margin-bottom:20px;">
        <option value="register">Registrasi</option>
        <option value="snack">Ambil Snack</option>
    </select>

    <div id="reader" style="width:300px; margin:auto;"></div>
    <p id="msg" style="font-size:22px; font-weight:bold; margin-top:20px;"></p>

    <script>
        const WEB_APP_URL = "https://script.google.com/macros/s/AKfycbwE8_2c1es0bBRBY4j-P_UNzBH7qAarKayVRhoICInROtjh9DKCItVJXJ25R4pJ_cpoZQ/exec"; // GANTI NANTI

        function onScanSuccess(result) {
            const mode = document.getElementById("mode").value;
            fetch(WEB_APP_URL, {
                method: "POST",
                body: JSON.stringify({ barcode: result, mode })
            })
                .then(res => res.json())
                .then(data => {
                    const msg = document.getElementById("msg");
                    msg.innerText = data.message;
                    msg.style.color = data.status === "success" ? "green" : "red";
                });
        }

        const reader = new Html5Qrcode("reader");
        reader.start({ facingMode: "environment" }, { fps: 10, qrbox: 200 }, onScanSuccess);
    </script>
</body>

</html>
